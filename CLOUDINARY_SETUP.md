# Cloudinary ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

SnapShare Eventã§ã¯ã€ç”»åƒã®ä¿å­˜ã¨CDNé…ä¿¡ã«Cloudinaryã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€Cloudinaryã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ ãªãœCloudinary?

- **é«˜é€Ÿé…ä¿¡**: ä¸–ç•Œä¸­ã®CDNã‹ã‚‰ç”»åƒã‚’é…ä¿¡
- **ç”»åƒå¤‰æ›**: URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§è‡ªå‹•ãƒªã‚µã‚¤ã‚ºãƒ»æœ€é©åŒ–
- **ã‚³ã‚¹ãƒˆå‰Šæ¸›**: ç„¡æ–™æ ãŒå……å®Ÿï¼ˆ25GB/æœˆã€25GBå¸¯åŸŸå¹…/æœˆï¼‰
- **ç°¡å˜ç®¡ç†**: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å…¨ç”»åƒã‚’ç®¡ç†

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. Cloudinaryã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆ

1. [Cloudinary](https://cloudinary.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€ŒSign Up for Freeã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ç™»éŒ²
4. ãƒ¡ãƒ¼ãƒ«èªè¨¼ã‚’å®Œäº†

### 2. Cloud Nameãªã©èªè¨¼æƒ…å ±ã®å–å¾—

1. Cloudinaryãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒ­ã‚°ã‚¤ãƒ³
2. å·¦ä¸Šã®ã€ŒDashboardã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ä»¥ä¸‹ã®æƒ…å ±ã‚’ãƒ¡ãƒ¢ï¼š
   - **Cloud Name**: ã‚ãªãŸã®ã‚¯ãƒ©ã‚¦ãƒ‰åï¼ˆä¾‹ï¼š`dxyz1234`ï¼‰
   - **API Key**: APIã‚­ãƒ¼ï¼ˆä¾‹ï¼š`123456789012345`ï¼‰
   - **API Secret**: APIã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼ˆä¾‹ï¼š`abcdefghijklmnopqrstuvwxyz123`ï¼‰

### 3. Upload Presetã®ä½œæˆ

Upload Presetã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ç›´æ¥ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ï¼ˆUnsigned Uploadï¼‰ã€‚

1. Cloudinaryãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€ŒSettingsã€ï¼ˆâš™ï¸ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€ŒUploadã€ã‚¿ãƒ–ã‚’é¸æŠ
3. ã€ŒUpload presetsã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
4. ã€ŒAdd upload presetã€ã‚’ã‚¯ãƒªãƒƒã‚¯
5. ä»¥ä¸‹ã®è¨­å®šã‚’è¡Œã†ï¼š
   - **Preset name**: `snapshare_preset`ï¼ˆä»»æ„ã®åå‰ï¼‰
   - **Signing Mode**: ã€ŒUnsignedã€ã‚’é¸æŠ
   - **Folder**: `snapshare`ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
   - **Use filename or externally defined Public ID**: ON
   - **Unique filename**: OFFï¼ˆPublic IDã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ï¼‰
6. ã€ŒSaveã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### 4. ç’°å¢ƒå¤‰æ•°ã®è¨­å®šï¼ˆæ¨å¥¨ï¼‰

#### macOS / Xcode

ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€èªè¨¼æƒ…å ±ã‚’ã‚³ãƒ¼ãƒ‰ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã›ãšã«ç®¡ç†ã§ãã¾ã™ã€‚

**æ–¹æ³•1: Xcodeã‚¹ã‚­ãƒ¼ãƒ ã§è¨­å®š**

1. Xcode > Product > Scheme > Edit Scheme...
2. ã€ŒRunã€ã‚’é¸æŠ
3. ã€ŒArgumentsã€ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯
4. ã€ŒEnvironment Variablesã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã€Œ+ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
5. ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¿½åŠ ï¼š

```
CLOUDINARY_CLOUD_NAME = your_cloud_name
CLOUDINARY_API_KEY = your_api_key
CLOUDINARY_API_SECRET = your_api_secret
CLOUDINARY_UPLOAD_PRESET = snapshare_preset
```

**æ–¹æ³•2: .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ï¼ˆé–‹ç™ºæ™‚ã®ã¿ï¼‰**

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼š

```bash
CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret
CLOUDINARY_UPLOAD_PRESET=snapshare_preset
```

æ³¨æ„: `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã¯`.gitignore`ã«è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

**æ–¹æ³•3: Cloudinary-Config.plistã‚’ä½¿ç”¨**

1. `Cloudinary-Config.plist.template`ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦`Cloudinary-Config.plist`ã‚’ä½œæˆ

```bash
cp Cloudinary-Config.plist.template Cloudinary-Config.plist
```

2. `Cloudinary-Config.plist`ã‚’ç·¨é›†ã—ã¦ã€å®Ÿéš›ã®å€¤ã‚’è¨­å®š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>CLOUDINARY_CLOUD_NAME</key>
    <string>your_cloud_name</string>

    <key>CLOUDINARY_API_KEY</key>
    <string>your_api_key</string>

    <key>CLOUDINARY_API_SECRET</key>
    <string>your_api_secret</string>

    <key>CLOUDINARY_UPLOAD_PRESET</key>
    <string>snapshare_preset</string>
</dict>
</plist>
```

3. Xcodeãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«`Cloudinary-Config.plist`ã‚’è¿½åŠ ï¼ˆãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ï¼‰

**é‡è¦**: ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯`.gitignore`ã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ã‚³ãƒŸãƒƒãƒˆã•ã‚Œã¾ã›ã‚“ã€‚

### 5. CloudinaryConfig.swiftã®æ›´æ–°ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã—ãªã„å ´åˆã¯ã€`CloudinaryConfig.swift`ã‚’ç›´æ¥ç·¨é›†ã§ãã¾ã™ï¼ˆéæ¨å¥¨ï¼‰ã€‚

```swift
struct CloudinaryConfig {
    static let cloudName = "your_cloud_name"
    static let apiKey = "your_api_key"
    static let apiSecret = "your_api_secret"
    static let uploadPreset = "snapshare_preset"
}
```

**è­¦å‘Š**: ã“ã®æ–¹æ³•ã¯é–‹ç™ºæ™‚ã®ã¿ä½¿ç”¨ã—ã€æœ¬ç•ªç’°å¢ƒã§ã¯ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

## âœ… å‹•ä½œç¢ºèª

1. Xcodeã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ“ãƒ«ãƒ‰ï¼†å®Ÿè¡Œ
2. ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å®Œäº†
3. ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆ
4. ã‚«ãƒ¡ãƒ©ã§å†™çœŸã‚’æ’®å½±
5. ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’ã‚¿ãƒƒãƒ—
6. Cloudinaryãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

### ç”»åƒã®ç¢ºèªæ–¹æ³•

1. Cloudinaryãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ > Media Library
2. `snapshare/groups/` ãƒ•ã‚©ãƒ«ãƒ€ã«ç”»åƒãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹
3. ç”»åƒã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è©³ç´°ã‚’ç¢ºèª

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: "CloudinaryãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“"

- ç’°å¢ƒå¤‰æ•°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- Xcodeã‚¹ã‚­ãƒ¼ãƒ ã®ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
- `CloudinaryConfig.isConfigured`ãŒtrueã‚’è¿”ã™ã‹ç¢ºèª

### ã‚¨ãƒ©ãƒ¼: "Upload failed: Unauthorized"

- API Keyã¨API SecretãŒæ­£ã—ã„ã‹ç¢ºèª
- Upload PresetãŒã€ŒUnsignedã€ãƒ¢ãƒ¼ãƒ‰ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª
- Upload PresetåãŒæ­£ã—ã„ã‹ç¢ºèª

### ã‚¨ãƒ©ãƒ¼: "Upload failed: Invalid signature"

- API SecretãŒæ­£ã—ã„ã‹ç¢ºèª
- Upload Presetã®Signing ModeãŒã€ŒUnsignedã€ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª

### ç”»åƒãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œãªã„

- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèª
- Cloudinaryãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®çŠ¶æ…‹ã‚’ç¢ºèª
- Xcodeã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª

## ğŸ“Š ç„¡æ–™æ ã®åˆ¶é™

Cloudinaryã®ç„¡æ–™ãƒ—ãƒ©ãƒ³ã§ã¯ä»¥ä¸‹ã®åˆ¶é™ãŒã‚ã‚Šã¾ã™ï¼š

- **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: 25GB
- **å¸¯åŸŸå¹…**: 25GB/æœˆ
- **å¤‰æ›**: 25ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ/æœˆ
- **ç”»åƒæ•°**: ç„¡åˆ¶é™

MVPã¨ã—ã¦ã¯ååˆ†ã§ã™ãŒã€æœ¬ç•ªç’°å¢ƒã§ã¯å¿…è¦ã«å¿œã˜ã¦æœ‰æ–™ãƒ—ãƒ©ãƒ³ã¸ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚

## ğŸ¯ Cloudinaryã®æ´»ç”¨

### ç”»åƒå¤‰æ›ã®ä¾‹

Cloudinaryã®URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã€æ§˜ã€…ãªç”»åƒå¤‰æ›ãŒå¯èƒ½ã§ã™ï¼š

```swift
// ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆï¼ˆ200x200ã€ã‚¯ãƒ­ãƒƒãƒ—ï¼‰
let thumbnailUrl = cloudinaryService.generateThumbnailUrl(publicId: "photo_id")

// å¹…800pxã«ãƒªã‚µã‚¤ã‚º
let resizedUrl = cloudinaryService.generateOptimizedUrl(publicId: "photo_id", width: 800)

// å“è³ªè‡ªå‹•èª¿æ•´
let optimizedUrl = cloudinaryService.generateOptimizedUrl(publicId: "photo_id", quality: "auto")
```

### ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®æ“ä½œ

- **ç”»åƒã®æ¤œç´¢**: ã‚¿ã‚°ã‚„ãƒ•ã‚©ãƒ«ãƒ€ã§æ¤œç´¢
- **ç”»åƒã®å‰Šé™¤**: ä¸è¦ãªç”»åƒã‚’å‰Šé™¤
- **ä½¿ç”¨çŠ¶æ³ã®ç¢ºèª**: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¨å¸¯åŸŸå¹…ã®ä½¿ç”¨çŠ¶æ³ã‚’ç¢ºèª
- **URLç”Ÿæˆ**: å¤‰æ›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¦URLã‚’ç”Ÿæˆ

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### æœ¬ç•ªç’°å¢ƒã§ã®æ³¨æ„äº‹é …

1. **API Secretã®ä¿è­·**
   - ã‚³ãƒ¼ãƒ‰ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã—ãªã„
   - ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã™ã‚‹
   - Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„

2. **Upload Presetã®è¨­å®š**
   - Unsigned Uploadã‚’ä½¿ç”¨ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ç›´æ¥ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰
   - ãƒ•ã‚©ãƒ«ãƒ€ã‚’åˆ¶é™ï¼ˆ`snapshare/`ã®ã¿ï¼‰
   - ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’åˆ¶é™

3. **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**
   - å¿…è¦ã«å¿œã˜ã¦Signed URLã‚’ä½¿ç”¨
   - Rate limitingã‚’è¨­å®š

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [Cloudinaryå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://cloudinary.com/documentation)
- [iOS SDKãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://cloudinary.com/documentation/ios_integration)
- [Upload Presetsã‚¬ã‚¤ãƒ‰](https://cloudinary.com/documentation/upload_presets)
- [ç”»åƒå¤‰æ›ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://cloudinary.com/documentation/image_transformations)

---

**ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ãŸã‚‰ã€[QUICKSTART.md](QUICKSTART.md)ã«æˆ»ã£ã¦ã‚¢ãƒ—ãƒªã®å‹•ä½œç¢ºèªã‚’è¡Œã£ã¦ãã ã•ã„ã€‚**
